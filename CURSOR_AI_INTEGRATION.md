# Cursor AI Integration

## Overview

This feature allows you to send generated contexts and listings directly to Cursor AI Pane, bypassing the file attachment mechanism that causes content clipping. Instead, the content is copied to the clipboard with clear instructions for pasting into Cursor AI.

## Features

### Control Panel Integration

**Send Context to AI**
- Location: AI Contexts section, next to "Generate Context" button
- Action: Generates the selected context template and copies it to clipboard for Cursor AI
- Icon: `codicon-send`

**Send Listing to AI**  
- Location: Inspect section, next to "Generate Listing" button
- Action: Generates the selected section listing and copies it to clipboard for Cursor AI
- Icon: `codicon-send`

### Stats Webview Integration

**Send to AI**
- Location: Actions bar, between "Refresh" and "Generate" buttons
- Action: Generates the content (context or listing) and copies it to clipboard for Cursor AI
- Works for both context and section scopes

## User Experience

1. **Click "Send to AI" button** â†’ Content is generated and copied to clipboard
2. **Detailed notification appears** with:
   - Content size information (e.g., "42.3K chars")
   - Step-by-step instructions
   - "Open Cursor AI" button (attempts to open Cursor AI Pane)
3. **User follows instructions**:
   - Open Cursor AI Pane (Ctrl+L or Cmd+L)
   - Paste content (Ctrl+V or Cmd+V)
   - Start conversation

## Technical Implementation

### CursorAiService

Core service located at `src/services/CursorAiService.ts`:

- **`sendContext(templateName, content)`** - Sends context with appropriate prefix
- **`sendListing(sectionName, mode, content)`** - Sends listing with appropriate prefix  
- **`sendToAI(content, options)`** - Core method with clipboard + notifications

### Content Prefixes

Generated content includes helpful prefixes:

**Context:**
```markdown
# ðŸŽ¯ LG Context: template-name

Generated by Listing Generator from template `template-name`.
This context was carefully prepared to fit within model limits.

[actual content follows]
```

**Listing:**
```markdown
# ðŸ“‹ LG Listing: section-name (mode)

Generated by Listing Generator from section `section-name` in `mode` mode.
This listing includes only relevant files that passed the configured filters.

[actual content follows]
```

## Benefits

1. **No Content Clipping** - Bypasses Cursor AI's automatic file attachment truncation
2. **Preserved Token Optimization** - Full LG optimization is maintained  
3. **Clear Context** - Prefixes help AI understand the content source and purpose
4. **User Control** - User explicitly decides when and what to send to AI
5. **Size Awareness** - Clear size indicators help manage context window usage

## Fallback Strategy

When direct Cursor AI API is unavailable (current state), the implementation uses:

1. **Clipboard Integration** - Reliable cross-platform approach
2. **Rich Notifications** - Clear instructions for user
3. **Command Attempts** - Tries common Cursor AI commands to open pane
4. **Manual Fallback** - Clear instructions if automatic opening fails

## Future Enhancements

When Cursor provides official AI Pane API:

1. Replace clipboard approach with direct message sending
2. Maintain existing UX and button locations
3. Add configuration options for integration method
4. Preserve content prefixes and size reporting

## Configuration

No additional configuration required. The integration works with existing LG settings and respects:

- Selected templates and sections
- Model configurations for size reporting
- Mode settings (all/changes)

## Testing

To test the integration:

1. **Open VS Code with LG extension**
2. **Ensure Cursor AI is available** (if using Cursor editor)
3. **Generate test content**:
   - Select a template â†’ Click "Send Context to AI"
   - Select a section â†’ Click "Send Listing to AI"
   - Use Stats webview â†’ Click "Send to AI"
4. **Verify clipboard content** and **follow notification instructions**
5. **Paste in Cursor AI** and verify content is complete and properly formatted
